import{t as C,d as H,i as _,c as $,h as je,e as L,f as n,F as Y,j as te,r as de,x as Ne,a as Me,y as Ee,z as O,n as ue,B as Le,q as Te,b as Je,C as I,v as pe,o as Ue,D as G,M as le,E as De,w as ce,k as Re,g as _e}from"./index.4716b654.js";import{R as ne}from"./rank.71a8a62d.js";import{s as ae}from"./message_box.236d7606.js";const Ie="_develop_1y9kf_1",Oe="_img_1y9kf_6",Ae="_main_1y9kf_13",Ge="_map_1y9kf_23",Ke="_row_1y9kf_34",We="_block_1y9kf_38",Fe="_unvisiable_1y9kf_54",He="_blocked_1y9kf_57",qe="_surface_1y9kf_67",Ve="_frogMap_1y9kf_72",Ye="_frog_1y9kf_72",Qe="_visiable_1y9kf_99",Xe="_arrow_1y9kf_105",Ze="_flat_1y9kf_115",et="_title_1y9kf_125",tt="_titleTextBox_1y9kf_133",nt="_titleText_1y9kf_133",it="_board_1y9kf_146",st="_p_1y9kf_160",rt="_giveUp_1y9kf_163",v={develop:Ie,img:Oe,main:Ae,map:Ge,row:Ke,block:We,unvisiable:Fe,blocked:He,surface:qe,frogMap:Ve,frog:Ye,visiable:Qe,arrow:Xe,flat:Ze,title:et,titleTextBox:tt,titleText:nt,board:it,p:st,giveUp:rt,"button-appear":"_button-appear_1y9kf_1"},ot="_BattleModal_bg6n6_1",lt="_main_bg6n6_8",at="_left_bg6n6_16",dt="_right_bg6n6_23",vt="_rank_bg6n6_29",ct="_progress_bg6n6_34",_t="_hp_bg6n6_42",ut="_died_bg6n6_56",K={BattleModal:ot,main:lt,left:at,right:dt,rank:vt,progress:ct,hp:_t,died:ut},ft=C('<img src="/images/dragon.png" width="auto" height="60%">');function $t(){return(()=>{const e=ft.cloneNode(!0);return e.style.setProperty("position","relative"),e.style.setProperty("top","15%"),e.style.setProperty("right","2%"),e})()}const gt=C('<img src="/images/kerberos.png" width="auto" height="70%">');function yt(){return(()=>{const e=gt.cloneNode(!0);return e.style.setProperty("position","relative"),e.style.setProperty("top","15%"),e.style.setProperty("right","3%"),e.style.setProperty("transform","rotateY(180deg)"),e})()}const ht=C('<img src="/images/behemoth.png" width="auto" height="70%">');function mt(){return(()=>{const e=ht.cloneNode(!0);return e.style.setProperty("position","relative"),e.style.setProperty("top","15%"),e.style.setProperty("right","3%"),e})()}const kt="_BattleCharacter_12z8a_1",wt="_onBattle_12z8a_15",bt="_right_12z8a_18",xt="_skills_12z8a_24",Pt="_skill_12z8a_24",Ct="_status_12z8a_41",pt="_died_12z8a_47",zt="_dialog_12z8a_57",W={BattleCharacter:kt,onBattle:wt,right:bt,skills:xt,skill:Pt,status:Ct,died:pt,dialog:zt},Bt=C('<div><img src="/images/man1.png" width="160%"></div>');function Mt(){return(()=>{const e=Bt.cloneNode(!0),i=e.firstChild;return e.style.setProperty("position","relative"),e.style.setProperty("width","30%"),e.style.setProperty("overflow","hidden"),i.style.setProperty("position","relative"),i.style.setProperty("left","-27%"),e})()}const St=C('<div><img src="/images/man2.png" width="320%"></div>');function jt(){return(()=>{const e=St.cloneNode(!0),i=e.firstChild;return e.style.setProperty("position","relative"),e.style.setProperty("width","30%"),e.style.setProperty("overflow","hidden"),i.style.setProperty("position","relative"),i.style.setProperty("left","-110%"),e})()}const Nt=C('<div><img src="/images/woman1.png" width="220%"></div>');function Et(){return(()=>{const e=Nt.cloneNode(!0),i=e.firstChild;return e.style.setProperty("position","relative"),e.style.setProperty("width","30%"),e.style.setProperty("overflow","hidden"),i.style.setProperty("position","relative"),i.style.setProperty("left","-60%"),e})()}const Lt=C('<div><img src="/images/woman2.png" width="180%"></div>');function Tt(){return(()=>{const e=Lt.cloneNode(!0),i=e.firstChild;return e.style.setProperty("position","relative"),e.style.setProperty("width","30%"),e.style.setProperty("overflow","hidden"),i.style.setProperty("position","relative"),i.style.setProperty("left","-50%"),e})()}const Jt=C("<div><div></div><div></div><div><div>\u6280<!>\u7ECF<!>\u5FC3</div><div></div></div></div>"),Ut=C("<div></div>");function E(){const[e,i]=H({});return new Proxy(e(),{set(u,w,T){return i({...u,[w]:T}),!0},get(u,w){if(console.log(w),console.log(e()),w==="onBattle")return e()[w]}})}const ze=["\u6211\u4E0D\u662F\u753B\u997C\uFF0C\u8FD9\u4E2A\u9879\u76EE\u505A\u5B8C\u5927\u5BB6\u90FD\u6709\u597D\u5904","\u62A5\u544A\u6211\u6536\u5230\u4E86\uFF0C\u8FD9\u4E2A\u5C0F\u4F19\u5B50\u505A\u5F97\u4E0D\u9519","\u662F\u516C\u53F8\u7ED9\u4E86\u4F60\u5DE5\u4F5C\u673A\u4F1A\uFF0C\u4F60\u8FDE\u8FD9\u70B9\u4E8B\u90FD\u505A\u4E0D\u597D\uFF0C\u516C\u53F8\u51ED\u4EC0\u4E48\u517B\u4F60","\u89C4\u77E9\u7B2C\u4E00\u6761\uFF0C\u4E0D\u5141\u8BB8\u8D8A\u7EA7\u4E0A\u62A5","\u8D4B\u80FD","\u6293\u624B"];function Be(e){return e.skillIds.indexOf(Ne.\u5FEB\u4E50\u9752\u5E74)>=0}function Dt(e){const i={man1:Mt,man2:jt,woman1:Et,woman2:Tt}[e.jinzai.avatar],[A,u]=H(!1),[w,T]=H("");function b(o){return u(!0),setTimeout(()=>{u(!1)},300),Be(e.jinzai)&&!o.filter(x=>x.mental>0).every(x=>Be(x))?(T(ze[de(ze.length)]),setTimeout(()=>{T("")},1e3),!1):!0}return e.bref&&(e.bref.onBattle=b),(()=>{const o=Jt.cloneNode(!0),x=o.firstChild,J=x.nextSibling,M=J.nextSibling,y=M.firstChild,p=y.firstChild,h=p.nextSibling,S=h.nextSibling,c=S.nextSibling;c.nextSibling;const m=y.nextSibling;return _(J,w),_(o,$(i,{}),M),_(y,$(ne,{get value(){return e.jinzai.technology}}),h),_(y,$(ne,{get value(){return e.jinzai.experience}}),c),_(y,$(ne,{get value(){return e.jinzai.mental}}),null),_(m,$(Y,{get each(){return e.jinzai.skillIds},children:d=>(()=>{const z=Ut.cloneNode(!0);return _(z,()=>je[d].name),L(()=>n(z,W.skill)),z})()})),L(d=>{const z=W.BattleCharacter,q={[W.onBattle]:A()},V={[W.died]:e.jinzai.mental<=0},s={[W.dialog]:!!w()},U=W.right,D=W.status,F=W.skills;return z!==d._v$&&n(o,d._v$=z),d._v$2=te(o,q,d._v$2),d._v$3=te(x,V,d._v$3),d._v$4=te(J,s,d._v$4),U!==d._v$5&&n(M,d._v$5=U),D!==d._v$6&&n(y,d._v$6=D),F!==d._v$7&&n(m,d._v$7=F),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),o})()}const Rt=C("<div><div><div></div><div><div></div><div>: </div><div>\u5B8C\u6210\u5EA6: <div></div></div></div></div></div>"),It=e=>{Me();const[i,A]=Ee(e.jinzais),u=O(()=>i),w=[$t,yt,mt][de(3)],T=["\u9700\u6C42","BUG"][de(2)],[b,o]=H(0),x=(e.rank+1)*100;ue(()=>{J()});function J(){setTimeout(()=>{const y=u().filter(c=>c.mental>0);if(y.length===0)return e.close();const p=de(y.length),h=y[p],S=u().indexOf(h);if(M[S].onBattle(e.jinzais)){o(h.technology/10+b());let c=Math.floor(h.technology/50+h.experience);const m=h.mental-(e.rank+1)*10;c>400&&(c=400),A(u().indexOf(h),d=>({experience:c,mental:m})),e.setJinzais(u)}b()<x?J():setTimeout(()=>{e.close()},500)},1500)}const M=[E(),E(),E(),E(),E(),E(),E(),E(),E(),E()];return(()=>{const y=Rt.cloneNode(!0),p=y.firstChild,h=p.firstChild,S=h.nextSibling,c=S.firstChild,m=c.nextSibling,d=m.firstChild,z=m.nextSibling,q=z.firstChild,V=q.nextSibling;return _(h,$(Y,{get each(){return u()},children:(s,U)=>$(Dt,{jinzai:s,get bref(){return M[U()]}})})),_(c,$(w,{})),_(m,T,d),_(m,$(ne,{get value(){return e.rank*100}}),null),L(s=>{const U=K.BattleModal,D=K.main,F=K.left,ie=K.right,r={[K.died]:b()>=x},a=K.rank,f=K.progress,k=K.hp,Q=b()/x*100+"%";return U!==s._v$&&n(y,s._v$=U),D!==s._v$2&&n(p,s._v$2=D),F!==s._v$3&&n(h,s._v$3=F),ie!==s._v$4&&n(S,s._v$4=ie),s._v$5=te(c,r,s._v$5),a!==s._v$6&&n(m,s._v$6=a),f!==s._v$7&&n(z,s._v$7=f),k!==s._v$8&&n(V,s._v$8=k),Q!==s._v$9&&V.style.setProperty("--percent",s._v$9=Q),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0}),y})()},ee=C("<div></div>"),Ot=C('<img src="/images/arrow.svg">'),At=C('<div><img src="/images/war.jpg"><div><div><div><div>\u5269\u4F59 <!> \u5929</div></div></div><div><div><img src="/images/flat.svg"></div></div><div><div>\u6E38\u620F\u76EE\u6807\uFF1A\u63A7\u5236\u56E2\u961F <img src="/images/arrow.svg"> \u79FB\u52A8\u5230\u7EC8\u70B9 <img src="/images/flat.svg"></div><div>\u64CD\u4F5C\u65B9\u6CD5\uFF1Awsad\u79FB\u52A8</div><div>\u989D\u5916\u8BF4\u660E\uFF1A\u7ECF\u9A8C\u5F71\u54CD\u89C6\u91CE\uFF0C\u6280\u672F\u5F71\u54CD\u533A\u5757\u96BE\u5EA6\u662F\u5426\u53EF\u89C1\u3002\u6BCF\u6B21\u884C\u52A8\u6D88\u8017\u4E00\u5929\u65F6\u95F4\uFF0C\u65F6\u95F4\u8017\u5C3D\u5219\u8FDB\u5165\u4E0B\u4E2A\u6708\u3002\u9879\u76EE\u6709\u4E00\u5B9A\u6982\u7387\u6839\u672C\u4E0D\u53EF\u5B8C\u6210\uFF0C\u53EF\u968F\u65F6\u653E\u5F03\u8BE5\u9879\u76EE\u2193\u3002</div><div data-content="\u653E\u5F03\u9879\u76EE">\u653E\u5F03\u9879\u76EE</div></div></div></div>');function Ft(){ue(()=>{Le(Te(async()=>!0)[0])});const[e,i]=Me(),A=Je(),[u,w]=H([]),T=[];for(let r of e.game.jinzais)T.push({...r});w(T);const b=O(()=>e.game.curMap),[o,x]=H(null),J=O(()=>e.game.curMap?.end??[]),M=O(()=>Math.floor(e.game.jinzais.sort((r,a)=>a.experience-r.experience)[0].experience/100)+1),y=O(()=>e.game.jinzais.sort((r,a)=>a.technology-r.technology)[0].technology),[p,h]=H(22);ue(()=>{b()||i(I.actions.initMap()),window.addEventListener("keydown",c)}),pe(()=>{o()||x(e.game.curPosition)}),Ue(()=>{window.removeEventListener("keydown",c)});function S(){window.addEventListener("keydown",c),window.removeEventListener("keyup",S)}function c(r){switch(window.removeEventListener("keydown",c),window.addEventListener("keyup",S),r.key){case"w":case"W":m(G.up);break;case"s":case"S":m(G.down);break;case"a":case"A":m(G.left);break;case"d":case"D":m(G.right);break}}function m(r){if(!o())return;let a=o()[0],f=o()[1];switch(r){case G.up:f=f-1;break;case G.down:f=f+1;break;case G.left:a=a-1;break;case G.right:a=a+1;break}const k=b();a<0||f<0||a>=k.width||f>=k.height||k.blocks[a][f].status===le.blocked||(h(p()-1),x([a,f]),k.blocks[a][f].status===le.default&&ie(k.blocks[a][f]))}pe(()=>{p()<=0&&V();const r=e.game.curMap;o()!==null&&r&&o()[0]===r.end[0]&&o()[1]===r.end[1]&&U()});function d(){A("/"),i(I.actions.setCurMap(null)),i(I.actions.setJinzais([...u()])),i(_e.actions.setIsNextMonth(!0)),D()}function z(){A("/"),i(I.actions.setCurMap(null)),i(I.actions.setJinzais([...u()])),i(_e.actions.setIsNextMonth(!0)),i(I.actions.addDevelopedProject(1)),D()}function q(){i(I.actions.setCurPosition(o())),i(I.actions.setJinzais([...u()])),i(_e.actions.setIsNextMonth(!0)),D(),A("/")}function V(){s(),ae("\u5DE5\u65F6\u8017\u5C3D\uFF0C\u8FDB\u5EA6\u5DF2\u4FDD\u5B58",{onClose:q})}function s(){window.removeEventListener("keyup",S),window.removeEventListener("keydown",c)}function U(){s(),ae("\u9879\u76EE\u5DF2\u5B8C\u6210\uFF0C\u672C\u6708\u5269\u4F59\u5DE5\u65F6\u5C06\u4F5C\u4E3A\u5458\u5DE5\u5047\u671F",{onClose:z})}function D(){i(I.actions.setJinzais(u().map(r=>({...r,mental:r.mental+(p()+8)*10}))))}function F(){s();let r;r=ae("\u771F\u7684\u8981\u653E\u5F03\u8BE5\u9879\u76EE\u5417\uFF1F",{onOk:()=>{d(),r&&r()},onClose:()=>{window.addEventListener("keydown",c)}})}function ie(r){s();let a;function f(){a&&a(),u().filter(k=>k.mental>0).length===0&&ae("\u961F\u4F0D\u5168\u706D",{onClose(){q()}}),window.addEventListener("keydown",c)}a=De($(It,{get rank(){return r.level},get jinzais(){return u()},setJinzais:w,close:f}))}return(()=>{const r=At.cloneNode(!0),a=r.firstChild,f=a.nextSibling,k=f.firstChild,Q=k.firstChild,ve=Q.firstChild,Se=ve.firstChild,fe=Se.nextSibling;fe.nextSibling;const X=k.nextSibling,se=X.firstChild,re=se.firstChild,$e=X.nextSibling,ge=$e.firstChild,ye=ge.nextSibling,he=ye.nextSibling,me=he.nextSibling;return _(ve,p,fe),_(X,$(ce,{get when(){return O(()=>!!b())()&&o()},get children(){const t=ee.cloneNode(!0);return _(t,$(Y,{get each(){return b().blocks},children:(l,P)=>(()=>{const g=ee.cloneNode(!0);return _(g,$(Y,{each:l,children:(B,R)=>(()=>{const j=ee.cloneNode(!0);return L(()=>n(j,v.frog)),j})()})),L(()=>n(g,v.row)),g})()})),L(l=>{const P=v.frogMap,g=o()[0],B=o()[1],R=M();return P!==l._v$&&n(t,l._v$=P),g!==l._v$2&&t.style.setProperty("--x",l._v$2=g),B!==l._v$3&&t.style.setProperty("--y",l._v$3=B),R!==l._v$4&&t.style.setProperty("--r",l._v$4=R),l},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t}}),se),_(se,$(ce,{get when(){return o()},get children(){const t=Ot.cloneNode(!0);return L(l=>{const P=v.arrow,g=o()[0],B=o()[1];return P!==l._v$5&&n(t,l._v$5=P),g!==l._v$6&&t.style.setProperty("--x",l._v$6=g),B!==l._v$7&&t.style.setProperty("--y",l._v$7=B),l},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),t}}),re),_(X,$(ce,{get when(){return O(()=>!!b())()&&o()},get children(){return $(Y,{get each(){return b().blocks},children:(t,l)=>(()=>{const P=ee.cloneNode(!0);return _(P,$(Y,{each:t,children:(g,B)=>{const R=O(()=>Math.abs(l()-o()[0])>M()||Math.abs(B()-o()[1])>M());return(()=>{const j=ee.cloneNode(!0);return _(j,(()=>{const N=O(()=>g.status===le.default&&!R());return()=>N()&&$(ne,{get value(){return y()>=g.level*100?g.level*100:-100}})})()),L(N=>{const Z=v.block,oe={[v.blocked]:g.status===le.blocked,[v.unvisiable]:R()};return Z!==N._v$23&&n(j,N._v$23=Z),N._v$24=te(j,oe,N._v$24),N},{_v$23:void 0,_v$24:void 0}),j})()}})),L(()=>n(P,v.row)),P})()})}}),null),me.$$click=F,L(t=>{const l=v.develop,P=v.main,g=v.title,B=v.titleTextBox,R=v.titleText,j=v.map,N=v.surface,Z=v.flat,oe=J()[0],ke=J()[1],we=v.board,be=v.p,xe=v.p,Pe=v.p,Ce=v.giveUp;return l!==t._v$8&&n(r,t._v$8=l),P!==t._v$9&&n(f,t._v$9=P),g!==t._v$10&&n(k,t._v$10=g),B!==t._v$11&&n(Q,t._v$11=B),R!==t._v$12&&n(ve,t._v$12=R),j!==t._v$13&&n(X,t._v$13=j),N!==t._v$14&&n(se,t._v$14=N),Z!==t._v$15&&n(re,t._v$15=Z),oe!==t._v$16&&re.style.setProperty("--x",t._v$16=oe),ke!==t._v$17&&re.style.setProperty("--y",t._v$17=ke),we!==t._v$18&&n($e,t._v$18=we),be!==t._v$19&&n(ge,t._v$19=be),xe!==t._v$20&&n(ye,t._v$20=xe),Pe!==t._v$21&&n(he,t._v$21=Pe),Ce!==t._v$22&&n(me,t._v$22=Ce),t},{_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0}),r})()}Re(["click"]);export{Ft as default};
